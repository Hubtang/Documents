# CPU 线程处理

### 测试目的:
通过配置【新建集群】或【编辑集群】下【优化设置介绍】中的【CPU 线程处理】，可以使得虚拟机的处理器核数量大于它们的主机所具有的处理器核数量，用户从而可以使用多个虚拟机来满足所需要的操作，达到降低对硬件的要求。

### 测试环境：
* engine 端,
* 一个 node，
  
  其 CPU 个数为:        
  ```
  $ grep 'physical id' /proc/cpuinfo | sort -u | wc -l 
  $ 1
  ```
  其 CPU 核数为：
  ```
  $ grep 'core id' /proc/cpuinfo | sort -u | wc -l
  $ 4
  ```
  其 CPU 线程总数为：
  ```
  $ grep 'processor' /proc/cpuinfo | sort -u | wc -l
  $ 8
  ```  
          
### 测试步骤：
1. 点击**集群**选项卡下的**新建**按钮，会弹出**新建集群**弹出框。

2. 在**常规**标签中，选择该集群从属的**数句中心**，输入集群的**名称**，**CPU 类型**，选择相应的**兼容版本**等，点击**确定**，成功创建一个新的集群。

3. 导航到**优化**标签，勾选 **CPU 线程**下的**将线程用作内核**。（此时在该台主机下创建的虚拟机的 CPU 总数最多可达到 8 块。）

4. 在树模型中点击刚刚创建的**集群**按钮，选择**主机**，此时结果列表中显示出三个与该集群相关的选项卡，分别是：**主机**，**域**和 **VM Backup**。  

5. 点击**主机**选项卡下的**新建**按钮，会弹出**新建主机**弹出框。

6. 分别输入该 node 的**名称**，**地址**，**密码**等，点击**确定**，为该集群添加了该 node。

7. 在树模型中点击刚刚添加的 node 下的**虚拟机**按钮，此时结果列表中显示出三个与该集群相关的选项卡，分别是：**虚拟机**，**域**和 **VM Backup**。

8. 点击**虚拟机**选项卡下的**新建虚拟机**按钮，会弹出**新建虚拟机**弹出框。

9. 在**常规**选项卡中，输入该虚拟机的**名称**，在**通过 vNIC 配置集实例化虚拟网卡。**下选择合适的网卡。

10.（1） 导航到**系统**选项卡，编辑**内存大小**（默认单位是 MB)，**虚拟 CPU 的总数**，分别添写 1-8 这 8 个数字，点击**确定**。

11.（1）点击**只运行一次**右边的绿色按钮，开启该虚拟机。

### 预期结果（1）：
虚拟机成功开启，没有弹出**！操作被取消**弹出框。

### 实际结果（1）：
与*预期结果*吻合。测试成功。

---------------------------

10.&nbsp;（2）导航到**系统**选项卡，编辑**内存大小**（默认单位是 MB)，**虚拟 CPU 的总数**，添写任何一个大于 8 的数字，点击**确定**。

11.&nbsp;（2）点击**只运行一次**右边的绿色按钮，开启该虚拟机。

### 预期结果（2）：
此时会弹出**！操作被取消**弹出框，报错内容：主机不满足内部过滤器 CPU，因为它没有足够的内核来运行虚拟机。

### 实际结果（2）：
与*预期结果*吻合。测试成功。
