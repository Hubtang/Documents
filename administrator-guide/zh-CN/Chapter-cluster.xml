<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "administrator-guide.ent">
%BOOK_ENTITIES;
]>
<chapter id="chap-Documents-administrator-guide-Chapter-cluster">
	<title>集群</title>
	<para>
	</para>
	<section id="sect-Documents-administrator-guide-Chapter-cluster_Section_1">
		<title>&OVIRT;集群介绍</title>
		<para>
                 集群是一组主机的集合，在同一集群下主机可共享相同的存储域，且CPU的
                 型号须同质（Intel或AMD）。如果主机之间有不同代的CPU，那么
                 只能体现最古老的那一代。
		</para>
                <para>
                 每个集群必然属于一个数据中心，每个主机也必然有一个集群，虚拟机会
                 动态的被分配到集群内的主机中，且可以在主机直接作迁移，关于迁移依
                 据的是集群所定义的一些规则（可在<emphasis>集群</emphasis>面板中配
                 置,集群是定义负载均衡和省电模式规则的最好级别）。
                </para>
                <para>
                 &OVIRT;集群分为两种，一种是运行虚拟机的，另外一种是&OVIRT_STORAGE;
                 在执行engine-setup的时候，可以选择，当然也可混在一起管理和使用。
                </para>
                <para>
                 &OVIRT;默认安装，会自动配置一个默认的数据中心，此数据中心下有一个
                 默认的集群。
                </para>
                <figure id="eayunos-Documents-administrator-guide-cluster-images">
                      <title>集群图示</title>
		   <mediaobject>
			<imageobject>
				<imagedata fileref="images/EayunOS_Cluster.png" format="PNG" scale="60"/>
			</imageobject>
		   </mediaobject>
                </figure>
                <para>
                 <emphasis>请参考:</emphasis>
                 <itemizedlist>
                   <listitem>
                     <para>
                      <link linkend="chap-Documents-administrator-guide-Chapter-data-center">第三章：数据中心</link>
                     </para>
                   </listitem>
                   <listitem>
                     <para>
                      <link linkend="chap-Logical_Networks">第五章：逻辑网络</link>
                     </para>
                   </listitem>
                   <listitem>
                     <para>
                      <link linkend="chap-Hosts">第六章：主机</link>
                     </para>
                   </listitem>
                   <listitem>
                     <para>
                     <link linkend="chap-Documents-administrator-guide-Chapter-storage-domain">第七章:存储域</link>
                     </para>
                   </listitem>
                 </itemizedlist>
                </para>
	</section>
	
	<section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2">
		<title>集群的任务</title>
		<para>
		</para>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-1">
		    <title>创建集群</title>
		    <para>
                      <emphasis>前提条件</emphasis>
                      <itemizedlist>
                         <listitem>
                           <para>
                            <link linkend="sect-Documents-administrator-guide-Chapter-data-center_Section_5-1">第三章第五节第一小节：创建新的数据中心</link>
                           </para>
                         </listitem>
                      </itemizedlist>
		    </para>
                    <formalpara><title>摘要</title>
                     <para>
                      一个数据中心可包含多个集群，一个集群可包含多个主机，同一集群下
                      的主机的CPU类型必须是一致的（intel或者是AMD），这里提醒的是尽
                      量在建立集群和主机之前确定CPU的属性，尽管&OVIRT;提供了<emphasis>
                      向导</emphasis>机制。
                     </para>
                    </formalpara>
                    <procedure><title>新建集群</title>
                      <step>
                       <para>
                        选择<emphasis>集群</emphasis>资源列表。  
                       </para>
                      </step>
                      <step>
                       <para>
                        点击<emphasis>新建</emphasis>按钮，会弹出<emphasis>新建集群
                        </emphasis>窗口。
                       </para>
                      </step>
                      <step>
                       <para>
                        在<emphasis>数据中心</emphasis> 项后的下来列表中选择集群的归属。
                       </para>
                      </step>
                      <step>
                       <para>
                        填写集群的<emphasis>名称</emphasis>和<emphasis>描述</emphasis>
                        以及<emphasis>注释</emphasis>。 
                       </para>
                      </step>
                      <step>
                       <para>
                         在下拉列表框中选择<emphasis>CPU类型</emphasis>和<emphasis>兼容
                         版本</emphasis>。如果集群中有不同代的CPU,请选择那个最低代的，否
                         则最低代的那台主机在加入后无法响应。
                       </para>
                      </step>
                      <step>
                       <para>
                        在<emphasis>启用Virt服务</emphasis>和<emphasis>启用gluster服务
                        </emphasis>之间，选择一个，点击单选框即可。这取决于将&OVIRT;用
                        于虚拟机管理还是用于&OVIRT_STORAGE;管理，这里提醒的一点是，&OVIRT;
                        Hypervisor Node 无法用于Gluster的集群节点。 
                       </para>
                      </step>
                      <step>
                       <para>
                        选择<emphasis>优化</emphasis>选项，可配置内存优化、是否激活CPU
                        线程以及是否启用内存ballooning。
                       </para>
                      </step>
                      <step>
                       <para>
                        选择<emphasis>Resilience策略</emphasis>选项，选择虚拟机的迁移策略。
                       </para>
                      </step>
                      <step>
                       <para>
                        选择<emphasis>集群策略</emphasis>选项，以配置负载均衡策略，选择
                        调度优化的方式，以及是否激活信任主机服务。 
                       </para>
                      </step>
                      <step>
                       <para>
                         点击<emphasis>确定</emphasis>按钮完成建立集群，&OVIRT;这时会弹出
                         <emphasis>新建集群-向导</emphasis>。
                       </para>
                      </step>
                      <step>
                       <para>
                         <emphasis>新建集群-向导</emphasis>会列出所有配置集群应该配置的项，
                         可以选择具体的项进行配置，也可以选择<emphasis>以后再配置</emphasis>
                         关闭窗口，以后如果再需要向导的时候，点击集群资源列表中的<emphasis>
                         引导操作</emphasis>即可。
                       </para>
                      </step>
                    </procedure>
 
                    <formalpara><title>结果</title>
                      <para>
                       新的集群在&OVIRT;虚拟化环境中。
                      </para>
                    </formalpara>
                    
                    <para>
                      <emphasis>请参考：</emphasis>
                      <itemizedlist>
                        <listitem>
                           <para>
                           <link linkend="sect-Documents-administrator-guide-Chapter-cluster_Section_2-2">下节内容：解释下新建/编辑集群弹出窗口的各项设置</link>
                           </para>
                        </listitem>
                        <listitem>
                           <para>
                           <link linkend="sect-Documents-administrator-guide-Chapter-basic_Section_2-4">第二章第四节：使用向导</link>
                           </para>
                        </listitem>
                      </itemizedlist>
                    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-2">
		    <title>解释下新建/编辑集群弹出窗口的各项设置</title>
		    <para>
		    </para>
	             <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-2-1">
		        <title>集群常规配置的解释</title>
                          <figure id="eayunos-Documents-administrator-guide-new-cluster-window">
                             <title>新建集群窗口</title>
		             <mediaobject>
			         <imageobject>
				    <imagedata fileref="images/EayunOS_New_Cluster_Window.png" format="PNG" scale="80"/>
			         </imageobject>
		             </mediaobject>
                          </figure>
		        <para>
                         当输入非正确的字段，会在用户点击<emphasis>确定</emphasis>按钮时出错
                         的部分会显示菊黄色的，且无法进行下一步的操作，通常情况下会提示预期
                         值或值范围不对。
		        </para>
                        <para>
                          下面的表格是在<emphasis>新建集群</emphasis>或<emphasis>编辑集群
                          </emphasis>窗口中<emphasis>通用</emphasis>tab下设置详细描述：
                        </para>
                        <table id="new_cluster_window_general_setting_table">
                            <title>集群通用设置</title>
                            <tgroup cols='2' align='left' colsep='1' rowsep='1'>
                              <thead>
                                   <row>
                                         <entry>
                                           填充项 
                                         </entry> 
                                         <entry>
                                            描述/操作
                                         </entry> 
                                   </row>
                              </thead>
                              <tbody>
                                   <row>
                                         <entry>
                                           数据中心
                                         </entry> 
                                         <entry>
                                           集群将加入的数据中心。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                           名称
                                         </entry> 
                                         <entry>
                                            集群的名称，可包含40个字符，尽量保证是独一无
                                            二的，可以是任意的大、小写字母，数字，短横线，
                                            下划线。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                           描述
                                         </entry> 
                                         <entry>
                                           集群的详细描述，&OVIRT;建议填写但不是强制性的。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                           CPU名称
                                         </entry> 
                                         <entry>
                                            集群的CPU类型，可从下列中选出：
                                            <itemizedlist>
                                                <listitem>
                                                   <para>
                                                    Intel Conroe Family 
                                                   </para>
                                                </listitem>
                                                <listitem>
                                                   <para>
                                                   Intel Penryn Family
                                                   </para>
                                                </listitem>
                                                <listitem>
                                                   <para>
                                                   Intel Nehalem Family
                                                   </para>
                                                </listitem>
                                                <listitem>
                                                   <para>
                                                   Intel Westmere Family
                                                   </para>
                                                </listitem>
                                                <listitem>
                                                   <para>
                                                   Intel SandyBridge Family
                                                   </para>
                                                </listitem>
                                                <listitem>
                                                   <para>
                                                   Intel Haswell
                                                   </para>
                                                </listitem>
                                                <listitem>
                                                   <para>
                                                   AMD Opteron G1
                                                   </para>
                                                </listitem>
                                                <listitem>
                                                   <para>
                                                   AMD Opteron G2
                                                   </para>
                                                </listitem>
                                                <listitem>
                                                   <para>
                                                   AMD Opteron G3
                                                   </para>
                                                </listitem>
                                                <listitem>
                                                   <para>
                                                   AMD Opteron G4
                                                   </para>
                                                </listitem>
                                                <listitem>
                                                   <para>
                                                   AMD Opteron G5
                                                   </para>
                                                </listitem>
                                            </itemizedlist>
                                            <para>
                                             集群内所有主机必须运行在同一型号的CPU（Intel或AMD）。
                                             且一旦集群建立后变动会非常的繁琐。CPU的类型选择尽可
                                             能的选择低代的，比如，一个拥有<emphasis>Intel Haswell
                                             </emphasis>的主机是可以加入到类型为<emphasis>Intel 
                                             Westmere Family</emphasis>的集群中的，相反，<emphasis>
                                             Intel Nehalem Family</emphasis>就不可以，且只能发挥低代
                                             的CPU的特性。
                                            </para>
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                          兼容版本 
                                         </entry> 
                                         <entry>
                                           &OVIRT;的版本号，你可以从以下选择：
                                           <itemizedlist>
                                                 <listitem>
                                                    <para>
                                                     3.0
                                                    </para>
                                                 </listitem>
                                                 <listitem>
                                                    <para>
                                                    3.1
                                                    </para>
                                                 </listitem>
                                                 <listitem>
                                                    <para>
                                                    3.2
                                                    </para>
                                                 </listitem>
                                                 <listitem>
                                                    <para>
                                                    3.3
                                                    </para>
                                                 </listitem>
                                           </itemizedlist>
                                           <para>
                                            用户不可以将集群的版本设置低于所在数据中心的版本。 
                                           </para>
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                          启用Virt服务 
                                         </entry> 
                                         <entry>
                                          如果这个单选框选中，运行在此集群下的主机被用于运行
                                          虚拟机。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                           启用Gluster服务
                                         </entry> 
                                         <entry>
                                           如果选中此单选框，运行在此集群下的主机将用户&OVIRT_STORAGE;
                                           的节点，不是运行虚拟机。且用户不能将&OVIRT; Hypervisor
                                           Node加入到此集群中。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                           导入现有的gluster集群配置
                                         </entry> 
                                         <entry>
                                            <para>
                                            此可选项仅用于当<emphasis>启用Gluster服务</emphasis>
                                            被选中时，此属性可以让用户导入一个已有的gluster集群，
                                            且其所包含的所有主机。
                                            </para>
                                            <para>
                                            下列属性是要导入的主机时填写的内容：
                                            </para>
                                            <itemizedlist>
                                               <listitem>
                                                 <para>
                                                 <emphasis>地址</emphasis>:输入Gluster主机的IP
                                                 地址或FQDN的名称。
                                                 </para>
                                               </listitem>
                                               <listitem>
                                                 <para>
                                                 <emphasis>SSH指印</emphasis>:&OVIRT;会尝试取得主机的
                                                 指印，以确保用户连接的是真需要连接的主机
                                                 </para>
                                               </listitem>
                                               <listitem>
                                                 <para>
                                                 <emphasis>密码</emphasis>:输入主机的root用户密码。
                                                 </para>
                                               </listitem>
                                            </itemizedlist>
                                         </entry> 
                                   </row>
                              </tbody>
                            </tgroup>
                        </table> 
                        <formalpara><title>请参考</title>
                           <para>
                             <link linkend="sect-Documents-administrator-guide-Chapter-cluster_Section_2-5">章节4.2.5：添加主机窗口的设置解释</link>  
                           </para>
                        </formalpara>    
	             </section>
	             <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-2-2">
		        <title>优化选项解释</title>
		        <para>
                         内存页共享，就是在某些虚拟机没有占用给它分配的内存时，可以给需要
                         更多内存的虚拟机，这个值最大可达到200%，当然这有个假设的前提条件
                         ，那就是在&OVIRT;虚拟化环境中，不是所有的虚拟机都达到饱和状态。
		        </para>
                        <para>
                          CPU线程，也就是可以运行虚拟机的总的CPU core数量大于主机所拥有的
                          core数量，这主要用于CPU负载不高的情形，在某种程度上可以降低对硬件
                          的要求。当然也需要考虑到虚拟机所运行的主机CPU的拓朴结构，以免出现
                          不能正常运行的情况，尤其是虚拟机的CPU core数量在主机的CPU core数量
                          和主机CPU的超线程数量之间。
                        </para>
                        <figure id="eayunos-Documents-administrator-optimization-settings-images">
                            <title>集群图示</title>
		            <mediaobject>
			        <imageobject>
				     <imagedata fileref="images/EayunOS_Optimization_Settings.png" format="PNG" scale="60"/>
			        </imageobject>
		            </mediaobject>
                        </figure>
                        <para>
                          下面的表格是在<emphasis>新建集群</emphasis>或<emphasis>编辑集群
                          </emphasis>窗口中<emphasis>优化</emphasis>tab下设置详细描述：
                        </para>
                        <table id="new_cluster_window_optimization_setting_table">
                            <title>集群优化设置</title>
                            <tgroup cols='2' align='left' colsep='1' rowsep='1'>
                              <thead>
                                   <row>
                                         <entry>
                                           填充项 
                                         </entry> 
                                         <entry>
                                            描述/操作
                                         </entry> 
                                   </row>
                              </thead>
                              <tbody>
                                   <row>
                                         <entry>
                                          内存优化 
                                         </entry> 
                                         <entry>
                                           <itemizedlist>
                                               <listitem>
                                                 <para>
                                                 <emphasis>无 - 禁用内存页面共享</emphasis>:即不使用
                                                 内存共享。 
                                                 </para>
                                               </listitem>
                                               <listitem>
                                                 <para>
                                                 <emphasis>用于服务器负载 - 设置页面共享为 150%</emphasis>
                                                 在集群的每台主机设置内存可共享上限为150%.
                                                 </para>
                                               </listitem>
                                               <listitem>
                                                 <para>
                                                 <emphasis>用于桌面负载 - 设置页面共享为 200%</emphasis>
                                                 在集群的每台主机设置内存可共享上限为200%.
                                                 </para>
                                               </listitem>
                                           </itemizedlist>
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                           CPU线程
                                         </entry> 
                                         <entry>
                                           <para>
                                            选择<emphasis>将线程用作内核</emphasis>多选框，则表示可以
                                            让虚拟机拥有的总的CPU core数量大于主机所拥有的数量。
                                           </para>
                                           <para>
                                            主机的超线程可以被虚拟机当作core来使用，例如，一台主机拥有
                                            12个core的超线程x2的CPU，则共24个超线程，那么虚拟机就可拥有
                                            24个core，但是带来的后果就是，CPU负载的计算算法将是平时的2
                                            倍。
                                           </para>
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                          内存Balloon 
                                         </entry> 
                                         <entry>
                                          <para>
                                          选择<emphasis>启用内存 Balloon 优化</emphasis>多选框，则表示
                                          在此集群中所有的主机激活内存超分配，一旦此选项生效，则内存超
                                          分配管理程序（MoM）就会启动Bollooning，Bollooning本身会有为每
                                          个虚拟机赋予一预先设定的值。
                                          </para>
                                          <para>
                                          Bollooning运行的前提是，运行在虚拟机客户操作系统里的驱动必须是
                                          工作的，在&OVIRT;中，除非用户手动删除，默认创建的虚拟机都会有
                                          Bollooning的设备。
                                          </para>
                                          <para>
                                          当设置完成后，当集群内的主机状态变为<emphasis>up</emphasis>时，
                                          都会更新Bolloon的策略。
                                          </para>
                                          <para>
                                          另外需要特别强调的一点是，在某些场景下bollooning和KSM会有冲突。
                                          大多数情况下，MoM会尝试调整bolloon大小将冲突降至最小，但还是有
                                          bollooning会引起虚拟机性能的次优，这里建立管理员慎用bollooning
                                          优化。
                                          </para>
                                         </entry> 
                                   </row>
                              </tbody>
                          </tgroup>
                        </table>
	             </section>
	             <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-2-3">
		        <title>弹性策略的解释</title>
		        <para>
                         弹性策略是根据主机宕机事件来设置虚拟机迁移的规则的意思。在同一集群的
                         前提下，运行在突然宕机或者处于维护模式的主机上的虚拟机，是要迁移到其
                         它主机中的；还有具体迁移还依赖于集群的策略。 
		        </para>
                        <note>
                          <para>
                             虚拟机迁移是严重依赖网络的。例如，一次的将运行10多台虚拟机迁移到
                             另外的主机，这将不仅会迁移很长的时间，还会影响到其他的性能，所以
                             选择一个合适的策略。保守的做法就是不做任何的迁移，当然，如果用户
                             拥有很多虚拟机，而有一些主机确实是负载非常的高（或重要），那么选
                             择仅迁移配置了高可用属性的虚拟机也是个不错的选择。
                          </para>
                        </note>
                        <para>
                         下面的表格是在<emphasis>新建集群</emphasis>或<emphasis>编辑集群
                          </emphasis>窗口中<emphasis>弹性策略</emphasis>tab下设置详细描述：  
                        </para>
                        <table id="new_cluster_window_esilience_policy_table">
                            <title>集群优化设置</title>
                            <tgroup cols='2' align='left' colsep='1' rowsep='1'>
                              <thead>
                                   <row>
                                         <entry>
                                           填充项 
                                         </entry> 
                                         <entry>
                                            描述/操作
                                         </entry> 
                                   </row>
                              </thead>
                              <tbody>
                                   <row>
                                         <entry>
                                            迁移虚拟机
                                         </entry> 
                                         <entry>
                                            根据预先定义的优先级顺序迁移全部的虚拟机。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                            仅迁移高可用虚拟机
                                         </entry> 
                                         <entry>
                                            仅迁移高可用虚拟机，以防止超载其他主机。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                            不迁移虚拟机
                                         </entry> 
                                         <entry>
                                            防止迁移过的虚拟机再迁移
                                            <!--此话有点别扭 -->
                                         </entry> 
                                   </row>
                              </tbody>
                           </tgroup>
                        </table>
	             </section>
	             <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-2-4">
		        <title>集群策略的解释</title>
		        <para>
                         集群策略是在可用的主机中指定使用和分发虚拟机。定义集群策略即是激活
                         集群中主机的自动负载均衡。
		        </para>
                        <figure id="eayunos-Documents-administrator-guide-cluster-plociy-window">
                            <title>负载均衡策略设置</title>
		            <mediaobject>
			        <imageobject>
				    <imagedata fileref="images/EayunOS_Cluster_Policy_Settings.png" format="PNG" scale="80"/>
			         </imageobject>
		             </mediaobject>
                        </figure>
                        <para>
                         下面的表格是在<emphasis>新建集群</emphasis>或<emphasis>编辑集群
                          </emphasis>窗口中<emphasis>集群策略</emphasis>tab下设置详细描述：  
                        </para>
                        <table id="new_cluster_window_cluster_policy_table">
                            <title>集群策略设置</title>
                            <tgroup cols='2' align='left' colsep='1' rowsep='1'>
                              <thead>
                                   <row>
                                         <entry>
                                           填充项 
                                         </entry> 
                                         <entry>
                                            描述/操作
                                         </entry> 
                                   </row>
                              </thead>
                              <tbody>
                                   <row>
                                         <entry>
                                           无 
                                         </entry> 
                                         <entry>
                                           设置策略为<emphasis>None</emphasis>，即表示不采用
                                           任何的负载或电源策略。此为默认选项。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                            平均分发
                                         </entry> 
                                         <entry>
                                           在同一集群中按照CPU的负载平均分配所有主机。当主机的
                                           负载达到预先定义的上限值时，就无法在此主机启动虚拟机。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                            节省电力
                                         </entry> 
                                         <entry>
                                            分配CPU的处理负载在可用主机，以减少对没有得到充分利
                                            用主机的功耗。当主机的CPU负载低到预设的下限值时，且
                                            超出预定义的时间间隔，则将这台主机中的所有虚拟机迁移
                                            到其它主机中，此主机可以关闭电源。。当主机的
                                           负载达到预先定义的上限值时，就无法在此主机启动虚拟机。 
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                            <emphasis>CpuOverCommitDurationMinutes</emphasis>
                                         </entry> 
                                         <entry>
                                          在集群策略生效之前，主机中运行的负载超过或低于预设值的
                                          时间间隔(以分钟为单位）。最大99分钟。在规定的时间间隔内
                                          可以防止由于临时高峰负载而启动集群策略，从而导致作出不
                                          必要的迁移。 
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                            <emphasis>HighUtilization</emphasis>
                                         </entry> 
                                         <entry>
                                           CPU的利用百分比。如果主机的CPU负载运行在预设值或之上，且超出
                                           预订时间间隔，&OVIRT;管理程序会迁移虚拟机到集群中其他
                                           主机中，直到CPU的负载低于这个预设值。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                           <emphasis>LowUtilization</emphasis> 
                                         </entry> 
                                         <entry>
                                           CPU的利用百分比。如果主机的CPU负载低于这个预设值，且超出预订
                                           时间间隔，&OVIRT;管理程序会将虚拟机迁移到集群中其他主机，
                                           管理程序不会关闭此主机，管理员必须手动去关闭。
                                         </entry> 
                                   </row>
                                   <row>
                                         <entry>
                                            <emphasis>启用信任的服务</emphasis>
                                         </entry> 
                                         <entry>
                                           是否激活与OpenAttestation服务的集成。在激活之前，请使用<emphasis>
                                           engine-config</emphasis>工具配置OpenAttestation服务的细节。
                                         </entry> 
                                   </row>
                                </tbody>
                               </tgroup>
                         </table>
                         <note>
                          <para>
                           当主机释放内存超过20%时，ballooning的命令在日志文件<emphasis>/var/log/vdsm/mom.log</emphasis>
                           会有类似的<emphasis>mom.Controllers.Balloon - INFO Ballooning guest:half1 from 10964 00 to
                           1991580 </emphasis>的记录。<emphasis>/var/log/vdsm/mom.log</emphasis>是内存超分配管理程序
                           日志记录文件。
                          </para>
                         </note>
	             </section>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-3">
		    <title>编辑资源</title>
		    <para>
                       属于&OVIRT_STORAGE;内容，&OVIRT;在稍后的版本中会增加此节的内容。
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-4">
		    <title>导入已经存在的&OVIRT;集群</title>
		    <para>
                       属于&OVIRT_STORAGE;内容，&OVIRT;在稍后的版本中会增加此节的内容。
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-5">
		    <title>添加主机窗口的设置解释</title>
		    <para>
                       属于&OVIRT_STORAGE;内容，&OVIRT;在稍后的版本中会增加此节的内容。
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-6">
		    <title>在集群中为主机设置负载策略</title>
		    <para>
                      集群的规则就是让用户指定CPU的上、下限制值，且当负载真的达到或超出
                      或低于上、下限制值的时候所采取的措施。定义了集群规则就意味着此集群
                      内拥有了在主机间的自动负载均衡功能。
		    </para>
                    <para>
                      当主机的CPU负载超过<emphasis>High Utilization</emphasis>值时，会迁移
                      虚拟机到其他主机上，以达到降低此主机的高负载。 
                    </para>
                    <para>
                      当主机的CPU负载低于<emphasis>Low Utilization</emphasis>值时，会将此
                      主机中运行的所有虚拟机迁移到其他主机中，迁移完成后，就可以关闭此主机
                      的电源，直到再次需要它才重新启动。
                    </para>
                    <procedure><title>设置负载均衡策略</title>
                        <step>
                           <para>
                            使用资源列表或树形结构或搜索功能，找到集群项，选择任意集群。
                           </para>
                        </step>
                        <step>
                           <para>
                            点击<emphasis>编辑</emphasis>，打开<emphasis>编辑集群</emphasis>
                            窗口。
                           </para>
                           <figure id="eayunos-Documents-administrator-guide-cluster-plociy-window-2">
                             <title>负载均衡策略设置</title>
		             <mediaobject>
			        <imageobject>
				    <imagedata fileref="images/EayunOS_Cluster_Policy_Settings.png" format="PNG" scale="80"/>
			         </imageobject>
		             </mediaobject>
                           </figure>
                        </step>
                        <step>
                           <para>
                            选择如下三种规则中的一种：
                              <itemizedlist>
                                 <listitem>
                                    <para>
                                      无
                                    </para>
                                 </listitem>
                                 <listitem>
                                    <para>
                                     <emphasis>Evenly_Distributed</emphasis>-在<emphasis>HighUtilization</emphasis>
                                     项后面的输入框内输入CPU利用率的百分比。  
                                    </para>
                                 </listitem>
                                 <listitem>
                                    <para>
                                     <emphasis>Power Saving</emphasis> - 此项下需要输入两个值，一个是<emphasis>
                                     LowUtilization</emphasis>,即低于这个CPU利用率的百分比，以及和<emphasis>
                                     Evenly_Distributed</emphasis>一样的最高的CPU利用率百分比阀值。   
                                    </para>
                                 </listitem>
                              </itemizedlist>
                           </para>
                        </step>
                        <step>
                           <para>
                             <emphasis>CpuOverCommitDurationMinutes</emphasis>输入框，可最多定义一个2位数字，
                             代表的以分钟为单位的时间，当负载超出或低于预设值时，并超出这个时间，则表示触发
                             集群策略。
                           </para>
                        </step>
                        <step>
                           <para>
                            如果用户使用OpenAttestation服务以验证主机，则使用<emphasis>engine-config</emphasis>
                            工具设置细节，并激活<emphasis>信任服务</emphasis>
                           </para>
                        </step>
                        <step>
                           <para>
                            点击<emphasis>确定</emphasis>。
                           </para>
                        </step>
                        <step>
                           <para>
                            结果：
                           </para>
                           <para>
                            为集群成功的更新了策略。
                           </para>
                        </step>
                    </procedure>
                    <formalpara><title>请参考</title>
                       <para>
                        <xref linkend="sect-Documents-administrator-guide-Chapter-cluster_Section_2-2-4"/>
                       </para>
                    </formalpara>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-7">
		    <title>建立逻辑网络（数据中心或集群）</title>
                    <formalpara><title>摘要</title>    
		      <para>
                       以下步骤为在数据中心或者集群中创建和定义逻辑网络。
		      </para>
                    </formalpara>
                    <procedure><title>定义逻辑网络</title>
                        <step>
                           <para>
                            使用<emphasis>数据中心</emphasis>或<emphasis>集群</emphasis>资源列表
                            或树形结构或搜索功能，选中结果列表。
                           </para>
                        </step>
                        <step>
                           <para>
                            点击<emphasis>逻辑网络</emphasis>,会自动列出现存在的逻辑网络。
                           </para>
                        </step>
                        <step>
                           <para>
                            在<emphasis>数据中心</emphasis>的详细列表中，点击<emphasis>新建</emphasis>
                            打开<emphasis>新建逻辑网络</emphasis>窗口；在<emphasis>集群</emphasis>
                            的详细列表中，点击<emphasis>添加网络</emphasis>打开<emphasis>新建逻辑网络
                            </emphasis>。
                           </para>
                           <figure id="eayunos-Documents-administrator-guide-create-new-logic-network">
                             <title>负载均衡策略设置</title>
		             <mediaobject>
			        <imageobject>
				    <imagedata fileref="images/EayunOS_Create_New_Logic_Network.png" format="PNG" scale="80"/>
			         </imageobject>
		             </mediaobject>
                           </figure>
                        </step>
                        <step>
                           <para>
                            为逻辑网络输入<emphasis>名称</emphasis>,<emphasis>描述</emphasis>,
                            <emphasis>注释</emphasis>。
                           </para>
                        </step>
                        <step>
                           <para>
                            在<emphasis>导出</emphasis>项中，选择<emphasis>在外部供应商上创建
                            </emphasis>,在<emphasis>外部供应商</emphasis>的下拉列表框中选择已
                            经建立好的外部供应商，并输入<emphasis>网络标签</emphasis>。
                           </para>
                        </step>
                        <step>
                           <para>
                            选择<emphasis>启用 VLAN 标签</emphasis>,<emphasis>虚拟机网络</emphasis>
                            ,<emphasis>覆盖 MTU</emphasis>,以激活对应的属性。
                           </para>
                        </step>
                        <step>
                           <para>
                           在<emphasis>集群</emphasis>标签下，选择欲将网络分配给某个集群，用户
                           也可指定此逻辑网络是必需的。
                           </para>
                        </step>
                        <step>
                           <para>
                            在<emphasis>配置集</emphasis>标签下，为逻辑网络分配<emphasis>vNIC profiles
                            </emphasis>。
                           </para>
                        </step>
                        <step>
                           <para>
                           点击<emphasis>确定</emphasis>。
                           </para>
                        </step>
                    </procedure>
                    <formalpara><title>结果</title>
                       <para>
                         用户已经定义所谓前提项的逻辑网络资源，此时可以给此集群中的主机添加此资源。
                       </para>
                    </formalpara>
                    <note>
                       <para>
                         当新建一逻辑网络或者是修改现有的逻辑网络用于显示网络时，原来使用此网络的
                         虚拟机必须重启后，此网络才可用。
                        <!-- 待验证 -->
                       </para>
                    </note>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-8">
		    <title>删除集群</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-9">
		    <title>使用管理网络窗口为网络指定合适的类型</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_2-10">
		    <title>管理网络窗口设置解释</title>
		    <para>
		    </para>
	        </section>
	</section>

	<section id="sect-Documents-administrator-guide-Chapter-cluster_Section_3">
		<title>集群和权限</title>
		<para>
		</para>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_3-1">
		    <title>集群下的系统管理权限</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_3-2">
		    <title>角色集群管理员的解释</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_3-3">
		    <title>为资源分配管理员或用户角色</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_3-4">
		    <title>删除赋予管理员或用户角色的权限</title>
		    <para>
		    </para>
	        </section>
	</section>

	<section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4">
		<title>集群和Gluster hooks</title>
		<para>
                    属于&OVIRT_STORAGE;内容，&OVIRT;在稍后的版本中会增加此章的内容。
                    请忽略下面的提纲。
		</para>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-1">
		    <title>管理Gluster Hooks</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-2">
		    <title>Hooks列表</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-3">
		    <title>查看Hooks内容</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-4">
		    <title>启用或禁止掉Hooks</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-5">
		    <title>刷新hooks</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-6">
		    <title>解决冲突</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-7">
		    <title>解决丢失hooks冲突</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-8">
		    <title>解决内容冲突</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-9">
		    <title>解决状态冲突</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-10">
		    <title>解决内容和状态冲突</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-11">
		    <title>解决内容、状态和丢失等冲突</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-12">
		    <title>管理Gluster Sync</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Section_4-13">
		    <title>导入主机到集群</title>
		    <para>
		    </para>
	        </section>
	        <section id="sect-Documents-administrator-guide-Chapter-cluster_Se3ction_4-14">
		    <title>将主机从集群中卸去</title>
		    <para>
		    </para>
	        </section>
	</section>

</chapter>

